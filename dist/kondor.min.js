(()=>{"use strict";var e={820:e=>{e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var t=e.charAt(o),s=t.charCodeAt(0);if(255!==r[s])throw new TypeError(t+" is ambiguous");r[s]=o}var i=e.length,a=e.charAt(0),d=Math.log(i)/Math.log(256),c=Math.log(256)/Math.log(i);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var n=0;if(" "!==e[n]){for(var o=0,t=0;e[n]===a;)o++,n++;for(var s=(e.length-n)*d+1>>>0,c=new Uint8Array(s);e[n];){var u=r[e.charCodeAt(n)];if(255===u)return;for(var l=0,p=s-1;(0!==u||l<t)&&-1!==p;p--,l++)u+=i*c[p]>>>0,c[p]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");t=l,n++}if(" "!==e[n]){for(var g=s-t;g!==s&&0===c[g];)g++;for(var f=new Uint8Array(o+(s-g)),h=o;g!==s;)f[h++]=c[g++];return f}}}return{encode:function(r){if(r instanceof Uint8Array||(ArrayBuffer.isView(r)?r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength):Array.isArray(r)&&(r=Uint8Array.from(r))),!(r instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===r.length)return"";for(var n=0,o=0,t=0,s=r.length;t!==s&&0===r[t];)t++,n++;for(var d=(s-t)*c+1>>>0,u=new Uint8Array(d);t!==s;){for(var l=r[t],p=0,g=d-1;(0!==l||p<o)&&-1!==g;g--,p++)l+=256*u[g]>>>0,u[g]=l%i>>>0,l=l/i>>>0;if(0!==l)throw new Error("Non-zero carry");o=p,t++}for(var f=d-o;f!==d&&0===u[f];)f++;for(var h=a.repeat(n);f<d;++f)h+=e.charAt(u[f]);return h},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error("Non-base"+i+" character")}}}},556:(e,r,n)=>{const{encodeText:o}=n(413);e.exports=class{constructor(e,r,n,t){this.name=e,this.code=r,this.codeBuf=o(this.code),this.alphabet=t,this.codec=n(t)}encode(e){return this.codec.encode(e)}decode(e){for(const r of e)if(this.alphabet&&this.alphabet.indexOf(r)<0)throw new Error(`invalid character '${r}' in '${e}'`);return this.codec.decode(e)}}},77:(e,r,n)=>{const o=n(820),t=n(556),{rfc4648:s}=n(727),{decodeText:i,encodeText:a}=n(413),d=[["identity","\0",()=>({encode:i,decode:a}),""],["base2","0",s(1),"01"],["base8","7",s(3),"01234567"],["base10","9",o,"0123456789"],["base16","f",s(4),"0123456789abcdef"],["base16upper","F",s(4),"0123456789ABCDEF"],["base32hex","v",s(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",s(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",s(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",s(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",s(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",s(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",s(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",s(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",s(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",o,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",o,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",o,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",o,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],c=d.reduce(((e,r)=>(e[r[0]]=new t(r[0],r[1],r[2],r[3]),e)),{}),u=d.reduce(((e,r)=>(e[r[1]]=c[r[0]],e)),{});e.exports={names:c,codes:u}},957:(e,r,n)=>{const o=n(77),{encodeText:t,decodeText:s,concat:i}=n(413);function a(e){if(Object.prototype.hasOwnProperty.call(o.names,e))return o.names[e];if(Object.prototype.hasOwnProperty.call(o.codes,e))return o.codes[e];throw new Error(`Unsupported encoding: ${e}`)}(r=e.exports=function(e,r){if(!r)throw new Error("requires an encoded Uint8Array");const{name:n,codeBuf:o}=a(e);return function(e,r){a(e).decode(s(r))}(n,r),i([o,r],o.length+r.length)}).encode=function(e,r){const n=a(e),o=t(n.encode(r));return i([n.codeBuf,o],n.codeBuf.length+o.length)},r.decode=function(e){e instanceof Uint8Array&&(e=s(e));const r=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(r)&&(e=e.toLowerCase()),a(e[0]).decode(e.substring(1))},r.isEncoded=function(e){if(e instanceof Uint8Array&&(e=s(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(e){return!1}},r.encoding=a,r.encodingFromData=function(e){return e instanceof Uint8Array&&(e=s(e)),a(e[0])};const d=Object.freeze(o.names),c=Object.freeze(o.codes);r.names=d,r.codes=c},727:e=>{e.exports={rfc4648:e=>r=>({encode:n=>((e,r,n)=>{const o="="===r[r.length-1],t=(1<<n)-1;let s="",i=0,a=0;for(let o=0;o<e.length;++o)for(a=a<<8|e[o],i+=8;i>n;)i-=n,s+=r[t&a>>i];if(i&&(s+=r[t&a<<n-i]),o)for(;s.length*n&7;)s+="=";return s})(n,r,e),decode:n=>((e,r,n)=>{const o={};for(let e=0;e<r.length;++e)o[r[e]]=e;let t=e.length;for(;"="===e[t-1];)--t;const s=new Uint8Array(t*n/8|0);let i=0,a=0,d=0;for(let r=0;r<t;++r){const t=o[e[r]];if(void 0===t)throw new SyntaxError("Invalid character "+e[r]);a=a<<n|t,i+=n,i>=8&&(i-=8,s[d++]=255&a>>i)}if(i>=n||255&a<<8-i)throw new SyntaxError("Unexpected end of data");return s})(n,r,e)})}},413:e=>{const r=new TextDecoder,n=new TextEncoder;e.exports={decodeText:e=>r.decode(e),encodeText:e=>n.encode(e),concat:function(e,r){const n=new Uint8Array(r);let o=0;for(const r of e)n.set(r,o),o+=r.length;return n}}},698:(e,r)=>{function n(e){return"object"!=typeof e?e:e.message?e.message:"unknown kondor error"}async function o(e){return new Promise((r=>setTimeout(r,e)))}Object.defineProperty(r,"__esModule",{value:!0}),r.Messenger=void 0;class t{constructor(e){if(this.listeners=[],this.onExtensionRequest=()=>Promise.resolve(),this.onDomRequest=()=>Promise.resolve(),e){if(e.onExtensionRequest){this.onExtensionRequest=e.onExtensionRequest;const r=async(e,r,n)=>{n();const{id:o,command:t}=e;if(!t)return;const s={id:o};try{const n=await this.onExtensionRequest(e,o,r);if("object"==typeof n&&null!==n&&n._derived)return;s.result=n}catch(e){s.error=e.message}(void 0!==s.result||s.error)&&this.sendResponse("extension",s,r)};this.listeners.push({type:"extension",id:"onRequest",listener:r}),chrome.runtime.onMessage.addListener(r)}if(e.onDomRequest){this.onDomRequest=e.onDomRequest;const r=async e=>{const{id:r,command:n}=e.data;if(!n)return;const o={id:r};try{const n=await this.onDomRequest(e,r);if("object"==typeof n&&null!==n&&n._derived)return;o.result=n}catch(e){o.error=e.message}(void 0!==o.result||o.error)&&this.sendResponse("dom",o)};this.listeners.push({type:"dom",id:"onRequest",listener:r}),window.addEventListener("message",r)}}}sendResponse(e,r,n){"dom"===e?window.postMessage(r,"*"):n&&n.tab?chrome.tabs.sendMessage(n.tab.id,r):chrome.runtime.sendMessage(r)}async sendDomMessage(e,r,o){const t=crypto.randomUUID();return new Promise(((s,i)=>{const a=e=>{if(e.data.command)return;const{id:r,result:o,error:a}=e.data;r===t&&(a?i(new Error(n(a))):s(o),this.removeListener(t))};this.listeners.push({type:"dom",id:t,listener:a}),window.addEventListener("message",a),window.postMessage({id:t,command:r,args:o?JSON.parse(JSON.stringify(o)):o,to:e},"*")}))}async sendExtensionMessage(e,r,t,s){const i=crypto.randomUUID();return new Promise(((a,d)=>{const c=(e,r,o)=>{if(o(),e.command)return;const{id:t,result:s,error:c}=e;t===i&&(c?d(new Error(n(c))):a(s),this.removeListener(i))};this.listeners.push({type:"extension",id:i,listener:c}),chrome.runtime.onMessage.addListener(c);const u=()=>{["popup","background"].includes(e)?chrome.runtime.sendMessage({id:i,command:r,args:t?JSON.parse(JSON.stringify(t)):t,to:e}):chrome.tabs.sendMessage(e,{id:i,command:r,args:t?JSON.parse(JSON.stringify(t)):t,to:e})};u(),s&&s.timeout&&setTimeout((()=>{d(new Error("Connection lost")),this.removeListener(i)}),s.timeout),s&&s.ping&&(async()=>{let r=(null==s?void 0:s.retries)||0;for(await o(1e3);this.listeners.find((e=>e.id===i));)try{await this.sendExtensionMessage(e,"ping",{id:i,to:e},{timeout:(null==s?void 0:s.pingTimeout)||80}),await o(1e3)}catch(e){if(r<=0){d(e),this.removeListener(i);break}r-=1,console.log(`retrying ${i}. remaining retries: ${r}`),u(),await o(100)}})().then((()=>{})).catch((e=>{console.log("ping error:"),console.log(e)}))}))}removeListener(e){const r=this.listeners.findIndex((r=>r.id===e));if(r<0)return;const n=this.listeners.splice(r,1),{listener:o,type:t}=n[0];"dom"===t?window.removeEventListener("message",o):chrome.runtime.onMessage.removeListener(o)}removeListeners(){this.listeners.forEach((e=>{const{type:r,listener:n}=e;"dom"===r?window.removeEventListener("message",n):chrome.runtime.onMessage.removeListener(n)})),this.listeners=[]}}r.default=t,r.Messenger=t},339:(e,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getAccounts=void 0;const o=n(698),t=n(601),s=new o.Messenger;async function i(){return s.sendDomMessage("popup","getAccounts",{kondorVersion:t.kondorVersion})}r.getAccounts=i,r.default=i},601:function(e,r,n){var o=this&&this.__createBinding||(Object.create?function(e,r,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return r[n]}})}:function(e,r,n,o){void 0===o&&(o=n),e[o]=r[n]}),t=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(r,e,n);return t(r,e),r};Object.defineProperty(r,"__esModule",{value:!0}),r.kondorVersion=void 0;const i=s(n(147));r.kondorVersion=i.version},599:(e,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.provider=r.getProvider=void 0;const o=n(698),t=n(601),s=new o.Messenger({});function i(e){return{call:async(r,n)=>s.sendDomMessage("background","provider:call",{network:e,method:r,params:n,kondorVersion:t.kondorVersion}),getNonce:async r=>s.sendDomMessage("background","provider:getNonce",{network:e,account:r,kondorVersion:t.kondorVersion}),getNextNonce:async r=>s.sendDomMessage("background","provider:getNextNonce",{network:e,account:r,kondorVersion:t.kondorVersion}),getAccountRc:async r=>s.sendDomMessage("background","provider:getAccountRc",{network:e,account:r,kondorVersion:t.kondorVersion}),getTransactionsById:async r=>s.sendDomMessage("background","provider:getTransactionsById",{network:e,transactionIds:r,kondorVersion:t.kondorVersion}),getBlocksById:async(r,n)=>s.sendDomMessage("background","provider:getBlocksById",{network:e,blockIds:r,opts:n,kondorVersion:t.kondorVersion}),getHeadInfo:async()=>s.sendDomMessage("background","provider:getHeadInfo",{network:e,kondorVersion:t.kondorVersion}),getChainId:async()=>s.sendDomMessage("background","provider:getChainId",{network:e,kondorVersion:t.kondorVersion}),getBlocks:async(r,n,o,i)=>s.sendDomMessage("background","provider:getBlocks",{network:e,height:r,numBlocks:n,idRef:o,opts:i,kondorVersion:t.kondorVersion}),getBlock:(r,n)=>s.sendDomMessage("background","provider:getBlock",{network:e,height:r,opts:n,kondorVersion:t.kondorVersion}),wait:async(r,n,o)=>s.sendDomMessage("background","provider:wait",{network:e,txId:r,type:n,timeout:o,kondorVersion:t.kondorVersion}),async sendTransaction(r,n){const o=await s.sendDomMessage("background","provider:sendTransaction",{network:e,transaction:r,broadcast:n,kondorVersion:t.kondorVersion});return r.id=o.transaction.id,r.header=o.transaction.header,r.operations=o.transaction.operations,r.signatures=o.transaction.signatures,r.wait=async(n="byBlock",o=6e4)=>s.sendDomMessage("background","provider:wait",{network:e,txId:r.id,type:n,timeout:o,kondorVersion:t.kondorVersion}),{transaction:r,receipt:o.receipt}},submitBlock:async r=>s.sendDomMessage("background","provider:submitBlock",{network:e,block:r,kondorVersion:t.kondorVersion}),readContract:async r=>s.sendDomMessage("background","provider:readContract",{network:e,operation:r,kondorVersion:t.kondorVersion}),getForkHeads:async()=>s.sendDomMessage("background","provider:getForkHeads",{network:e,kondorVersion:t.kondorVersion}),getResourceLimits:async()=>s.sendDomMessage("background","provider:getResourceLimits",{network:e,kondorVersion:t.kondorVersion}),invokeSystemCall:async(r,n,o,i)=>s.sendDomMessage("background","provider:invokeSystemCall",{network:e,serializer:r,nameOrId:n,args:o,callerData:i,kondorVersion:t.kondorVersion}),invokeGetContractMetadata:async r=>s.sendDomMessage("background","provider:getResourceLimits",{network:e,contractId:r,kondorVersion:t.kondorVersion})}}r.getProvider=i,r.provider=i(),r.default=r.provider},942:(e,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getSigner=r.KondorSigner=void 0;const o=n(698),t=n(601),s=n(593),i=new o.Messenger({});class a{constructor(e){this.provider=e.provider,this.address=e.address,this.sendOptions={broadcast:!0,...e.sendOptions}}getAddress(){return this.address}signHash(e){return i.sendDomMessage("popup","signer:signHash",{signerAddress:this.address,hash:e,kondorVersion:t.kondorVersion})}async signMessage(e){const r=await i.sendDomMessage("popup","signer:signMessage",{signerAddress:this.address,message:e,kondorVersion:t.kondorVersion});return(0,s.decodeBase64url)(r)}async signTransaction(e,r){const n=await i.sendDomMessage("popup","signer:signTransaction",{signerAddress:this.address,transaction:e,abis:r,kondorVersion:t.kondorVersion});return e.id=n.id,e.header=n.header,e.operations=n.operations,e.signatures=n.signatures,e}async sendTransaction(e,r){const n={...this.sendOptions,...r};if(null==n?void 0:n.beforeSend)throw new Error("beforeSend option is not supported in kondor");const o=await i.sendDomMessage("popup","signer:sendTransaction",{signerAddress:this.address,transaction:e,optsSend:n,kondorVersion:t.kondorVersion});return e.id=o.transaction.id,e.header=o.transaction.header,e.operations=o.transaction.operations,e.signatures=o.transaction.signatures,n.broadcast&&(e.wait=async(r="byTransactionId",n=15e3)=>{if(!this.provider)throw new Error("provider is undefined");return this.provider.wait(e.id,r,n)}),{transaction:e,receipt:o.receipt}}async prepareBlock(){throw new Error("prepareBlock is not available")}async signBlock(){throw new Error("signBlock is not available")}}r.KondorSigner=a,r.getSigner=function(e,r){if(!e)throw new Error("no signerAddress defined");return new a({provider:null==r?void 0:r.provider,address:e,sendOptions:null==r?void 0:r.sendOptions})}},593:function(e,r,n){var o=this&&this.__createBinding||(Object.create?function(e,r,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return r[n]}})}:function(e,r,n,o){void 0===o&&(o=n),e[o]=r[n]}),t=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(r,e,n);return t(r,e),r};Object.defineProperty(r,"__esModule",{value:!0}),r.decodeBase64url=void 0;const i=s(n(957));r.decodeBase64url=function(e){return i.decode(`U${e}`)}},147:e=>{e.exports=JSON.parse('{"name":"kondor-js","version":"1.2.0","description":"Kondor Library","author":"Julian Gonzalez","repository":{"url":"https://github.com/joticajulian/kondor-js.git"},"homepage":"https://github.com/joticajulian/kondor-js.git","bugs":{"url":"https://github.com/joticajulian/kondor-js/issues"},"files":["lib","dist","src"],"main":"./lib/browser/src/index.js","types":"./lib/browser/src/index.d.ts","browser":"./lib/browser/src/index.js","scripts":{"build":"rimraf lib/browser && tsc -p tsconfig.browser.json","bundle":"yarn bundle:no-min && yarn bundle:min && yarn testfiles","bundle:min":"webpack --mode=production --config webpack.prod.config.js","bundle:no-min":"webpack --mode=production --config webpack.dev.config.js","lint":"yarn lint:prettier && yarn lint:eslint && yarn lint:tsc","lint:prettier":"prettier . --check","lint:eslint":"eslint . --ext .js,.ts","lint:tsc":"tsc --noEmit --incremental false","prerelease":"yarn bundle && yarn build","serve":"node test/server.js","testfiles":"copyfiles -u 3 node_modules/koilib/dist/koinos.min.js test/js && copyfiles -u 1 dist/kondor.min.js test/js"},"exports":{"./package.json":"./package.json",".":"./lib/browser/src/index.js"},"dependencies":{"multibase":"^4.0.6"},"devDependencies":{"@tsconfig/node12":"^1.0.11","@types/chrome":"^0.0.195","@typescript-eslint/eslint-plugin":"^5.35.1","@typescript-eslint/parser":"^5.35.1","copyfiles":"^2.4.1","eslint":"^8.22.0","eslint-config-airbnb-typescript":"^17.0.0","eslint-config-prettier":"^8.3.0","eslint-plugin-import":"^2.25.4","eslint-plugin-prettier":"^4.2.1","eslint-plugin-tsdoc":"^0.2.16","fastify":"^3.26.0","fastify-static":"^4.5.0","koilib":"^9.1.0","prettier":"^2.7.1","rimraf":"^3.0.2","ts-loader":"~8.2.0","typescript":"4.5.4","webpack":"^5.88.2","webpack-cli":"^5.1.4"}}')}},r={};function n(o){var t=r[o];if(void 0!==t)return t.exports;var s=r[o]={exports:{}};return e[o].call(s.exports,s,s.exports,n),s.exports}(()=>{const e=n(599),r=n(942),o=n(339);window.kondor={provider:e.provider,getProvider:e.getProvider,KondorSigner:r.KondorSigner,getSigner:r.getSigner,getAccounts:o.getAccounts}})()})();